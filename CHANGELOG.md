# История версий / Changelog

Все важные изменения в проекте документируются в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект следует [Semantic Versioning](https://semver.org/lang/ru/).

---

## [0.4.2] - 2025-11-11

### Изменено
- Обновлена иконка приложения (удалены белые поля)
- Пересозданы все иконки для всех плотностей экранов
- Обновлены иконки для Google Play Store

---

## [0.4.1] - 2025-11-11

### Исправлено
- Исправлено отображение иконки приложения на Android 8.0+ (удалён adaptive icon)
- Добавлены круглые иконки (ic_launcher_round) для всех плотностей

---

## [0.4.0] - 2025-11-11

### Добавлено
- Новая иконка приложения (icon_LapLog_Free.png)
- Иконки для всех плотностей экранов (mdpi/hdpi/xhdpi/xxhdpi/xxxhdpi)
- Иконки для Google Play Store (512×512 и 1024×1024)
- Документация для публикации в Google Play (GOOGLE_PLAY_PUBLISHING.md)
- Каталог store_assets с маркетинговыми материалами

---

## [0.3.3] - 2025-11-11

### Изменено
- История: Duration, AVG и MEDIAN в заголовке отображаются обычным шрифтом (не DSEG7)
- История: Строка с количеством laps, AVG и MEDIAN показывается только в свернутом виде

---

## [0.3.2] - 2025-11-11

### Добавлено
- Выбор комментария до старта сессии на главном экране
- Автодополнение комментариев из ранее использованных
- Сохранение текущего комментария между сеансами приложения

### Изменено
- История: Duration в заголовке теперь разделено на обычный шрифт для метки и DSEG7 для времени
- История: Обратный порядок отображения лэпов (новые сверху)
- История: Одинаковая ширина знаков +/- (используется Unicode minus U+2212)
- История: Уменьшены размеры шрифтов для всех чисел
- История: Комментарий отображается в одной строке с датой (через em dash)
- История: AVG/MEDIAN показываются в свернутом виде в строке с количеством кругов

---

## [0.3.1] - 2025-11-10

### Изменено
- Форматирование индикатора разницы лэпов с DSEG7 шрифтом (+N.NN / -N.NN)
- Применен DSEG7 шрифт ко всем временным меткам в истории
- Миллисекунды теперь отображаются в истории для всех времен
- Улучшено выравнивание duration для всех лэпов (фиксированный резерв 72dp)

### Добавлено
- Функции `formatDifference()` в StopwatchViewModel и HistoryViewModel

### Исправлено
- Гарантированное выравнивание Lap 1 duration с остальными лэпами
- Консистентный layout лэпов между секундомером и историей

---

## [0.3.0] - 2025-11-10

### Добавлено
- DSEG7 цифровой шрифт (угловой/сегментный дисплей)
- Статистика лэпов: AVG/MEDIAN на секундомере и в истории
- Индикаторы разницы лэпов: +/-N.N s с цветовой кодировкой
  - Зеленый для быстрых лэпов (отрицательная разница)
  - Красный для медленных лэпов (положительная разница)
- Переключатель Collapse/Expand All в истории (UnfoldMore/UnfoldLess)
- Кнопка Lap+Pause (заполненный флаг) - одновременная отметка и пауза
- Секунды в временных метках сессий истории (HH:mm:ss)

### Изменено
- Переработана логика управляющих кнопок (зависит от состояния):
  - Остановлен (время=0): только кнопка [Start]
  - Запущен: [Pause] [Filled Flag] [Empty Flag]
  - На паузе: [Start] [Stop]
- Кнопка Reset заменена на Stop (Icons.Default.Stop)
- Комментарий перемещен в заголовок сессии (рядом с датой)
- Улучшен layout отображения лэпов с индикаторами разницы

### Исправлено
- Критическая ошибка сохранения сессий (Flow.collect → Flow.first)
- История теперь корректно отображает все сохраненные сессии

---

## [0.2.0] - 2025-11-09

### Добавлено
- База данных Room для хранения истории сессий
- Экран истории с отображением всех сохраненных сессий
- Навигация между секундомером и историей (BottomNavigationBar)
- Функция комментариев к сессиям с автодополнением
- Функции удаления:
  - Удаление отдельной сессии
  - Удаление всех сессий до выбранной
  - Удаление всех сессий
- Экспорт истории в CSV и JSON форматах
- Блокировка ориентации экрана (новый переключатель)
- Раскрывающиеся карточки сессий с детальной информацией о лэпах
- Диалог подтверждения для всех операций удаления

### Изменено
- Переключатели управления перемещены над таймером
- Удалены текстовые метки с переключателей (только иконки)
- Применен моноширинный шрифт ко всем временным отображениям
- Кнопки управления теперь только с иконками (32dp размер)
- Иконка блокировки ориентации: Lock/LockOpen

### Исправлено
- BuildConfig generation корректно настроен
- Сессии автоматически сохраняются при нажатии Reset

### Технические детали
- Room Database 2.6.1 с KSP
- SessionEntity и LapEntity с каскадным удалением
- SharedPreferences для настроек и использованных комментариев
- Storage Access Framework для экспорта файлов

---

## [0.1.1] - 2025-11-09

### Изменено
- Переименование приложения в "LapLog Free"
- Обновлен README (английский и русский)
- Обновлена лицензия с указанием авторства

### Исправлено
- BuildConfig generation включен в build configuration
- Удалены персональные пути из документации
- Обновлен URL репозитория на GitHub

---

## [0.1.0] - 2025-11-09

### Добавлено
- Базовый функционал секундомера (старт/пауза/сброс)
- Промежуточные отметки (Lap marks) с отображением времени и длительности
- Переключатель отображения миллисекунд
- Динамический формат времени (ММ:СС или ЧЧ:ММ:СС при ≥1 часа)
- Функция удержания экрана активным во время работы секундомера
- Темная тема (автоматическое переключение по системным настройкам)
- Material Design 3 интерфейс
- Диалог "О приложении" с отображением версии
- GitHub Actions для автоматической сборки APK

### Технические детали
- Jetpack Compose для UI
- MVVM архитектура (ViewModel + StateFlow)
- Минимальная версия Android: 7.0 (API 24)
- Целевая версия: Android 14 (API 34)

---

## Планируемые версии

### [1.0.0] - Планируется
- Финальная полировка перед публичным релизом
- Публикация в Google Play Store
- Release build с подписью
- Скриншоты и описание для магазина

---

## Легенда изменений

- **Добавлено** - новые функции
- **Изменено** - изменения в существующем функционале
- **Удалено** - удаленные функции
- **Исправлено** - исправление багов
- **Безопасность** - исправления уязвимостей

---

## Формат версий

- **MAJOR.MINOR.PATCH** (X.Y.Z)
  - **MAJOR** (X) - несовместимые изменения API
  - **MINOR** (Y) - новая функциональность (обратно совместимая)
  - **PATCH** (Z) - исправление ошибок (обратно совместимое)

- Версии **0.x.x** - pre-release (до публикации в Google Play)
- Версия **1.0.0** - первый публичный релиз в Google Play
